{
  "bookSourceGroup": "English",
  "bookSourceName": "ðŸŽ‡ WTR-LAB",
  "bookSourceType": 0,
  "bookSourceUrl": "https://wtr-lab.com",
  "customOrder": 4,
  "enabled": true,
  "enabledCookieJar": true,
  "enabledExplore": true,
  "exploreUrl": "Index::/novel-finder?orderBy=name&order=asc&ge=29%2C39&page={{page}}\nDaily::/ranking/daily?page={{page}}\nWeekly::/ranking/weekly?page={{page}}\nMonthly::/ranking/monthly?page={{page}}",
  "header": "{\n  \"Referer\": \"https://wtr-lab.com/\",\n  \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36\"\n}",
  "lastUpdateTime": 1762390885342,
  "respondTime": 180000,
  "ruleBookInfo": {
    "author": "//td[contains(text(),'Author')]/following-sibling::td//a/text()",
    "coverUrl": "//script[@id='__NEXT_DATA__']/text()<js>\nconst json = JSON.parse(result);\nresult = json.props.pageProps.serie.serie_data.data.image;\n</js>",
    "intro": "//script[@id='__NEXT_DATA__']/text()<js>\nconst json = JSON.parse(result);\nresult = json.props.pageProps.serie.serie_data.data.description;\n</js>",
    "kind": "//td[contains(text(),'Genre')]/following-sibling::td//a/text()",
    "name": "//h1/text()[not(ancestor::span[@class='rawtitle'])]<js>\nresult = result.replace(/\\n/g, ' ').replace(/\\s+/g, ' ').trim();\n</js>",
    "tocUrl": "//script[@id='__NEXT_DATA__']/text()<js>\nconst json = JSON.parse(result);\nvar id = json.query.sid || json.props?.pageProps?.serie?.serie_data?.data?.id || json.props?.pageProps?.serie?.serie_data?.id;\nif (!id) throw 'Error: Novel ID not found';\n'https://wtr-lab.com/api/chapters/' + id + '?start=1&end=9999';\n</js>"
  },
  "ruleContent": {
    "content": "<js>\n(function() {\n  var url = (typeof java !== 'undefined' && java.getUrl) ? java.getUrl() : (typeof src !== 'undefined' ? String(src) : '');\n  if (!url) throw 'Missing URL context';\n\n  var match = url.match(/novel\\/([0-9]+)\\/(?:[^\\/]+)\\/chapter-([0-9]+)/);\n  if (!match) throw 'Invalid chapter URL: ' + url;\n  var id = match[1];\n  var chapter = match[2];\n\n  var langMatch = url.match(/https?:\\/\\/[^\\/]+\\/([^\\/]+)\\/novel/);\n  var lang = langMatch ? langMatch[1] : 'en';\n\n  var body = JSON.stringify({\n    translate: 'ai',\n    language: lang,\n    raw_id: id,\n    chapter_no: chapter,\n    retry: false,\n    force_retry: false\n  });\n\n  var res = java.post('https://wtr-lab.com/api/reader/get', body,\n    {'Content-Type':'application/json;charset=UTF-8'}).body();\n\n  var json = JSON.parse(res);\n  var data = (json.data && json.data.data) ? json.data.data : {};\n  var lines = data.body || [];\n  var imgs  = data.images || [];\n\n  var content = '';\n  var imgIndex = 0;\n  for (var i = 0; i < lines.length; i++) {\n    var line = lines[i];\n    if (line === '[image]') {\n      var img = imgs[imgIndex++] || '';\n      if (img) content += '<img src=\\\"\" + img + \"\\\">';\n    } else {\n      content += '<p>' + line + '</p>';\n    }\n  }\n  return content.trim();\n})();\n</js>",
    "title": "//h1/text()"
  },
  "ruleExplore": {
    "bookList": "//div[@class='serie-item']",
    "bookUrl": "//a[contains(@class,'title')]/@href",
    "coverUrl": "//img[not(contains(@src,'svg'))]/@src",
    "intro": "//span[@class='description']/text()@js:result.replace(/\\n/g,'').replace(/\\s+/g,' ').trim()",
    "kind": "//div[@class='genres']/span/text()",
    "name": "//a[contains(@class,'title')]/text()"
  },
  "ruleSearch": {
    "bookList": "//div[@class='series-list']/div",
    "bookUrl": "//a[contains(@class,'title')]/@href",
    "checkKeyWord": "Alien Hotel",
    "coverUrl": "//img[not(contains(@src,'svg'))]/@src",
    "intro": "//span[@class='description']/text()@js:result.replace(/\\n/g,'').replace(/\\s+/g,' ').trim()",
    "kind": "//div[@class='genres']/span/text()",
    "name": "//a[contains(@class,'title')]/text()"
  },
  "ruleToc": {
    "chapterList": "$.chapters[*]",
    "chapterName": "#{{$.order}} - {{$.title}}<js>\nfunction toTitleCase(sentence){\n  const lowers=['a','an','and','the','in','on','at','by','for','of','with','to','but','or','nor','as'];\n  function multiCap(w){return (w.match(/[A-Z]/g)||[]).length>=2;}\n  return sentence.split(' ').map((w,i,a)=>{\n    const p=a[i-1];\n    if(i===0||i===a.length-1||multiCap(w)||(p&&(p.endsWith(':')||p.endsWith('-')))||!lowers.includes(w.toLowerCase()))\n      return w.charAt(0).toUpperCase()+w.slice(1);\n    return w.toLowerCase();\n  }).join(' ');\n}\nresult = toTitleCase(result.replace(/\\s+/g,' ').trim());\n</js>",
    "chapterUrl": "<js>\n'https://wtr-lab.com/en/serie-' + result.serie_id + '/chapter-' + result.order + '?service=google';\n</js>",
    "updateTime": "{{$.updated_at}}"
  },
  "searchUrl": "/novel-finder?ge=29%2C39&text={{key}}",
  "weight": 0
}
